(function(g,h,e){var a=g.event,b,j;b=a.special.debouncedresize={setup:function(){g(this).on("resize",b.handler)},teardown:function(){g(this).off("resize",b.handler)},handler:function(o,k){var n=this,m=arguments,l=function(){o.type="debouncedresize";a.dispatch.apply(n,m)};if(j){clearTimeout(j)}k?l():j=setTimeout(l,b.threshold)},threshold:50};var c="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";g.fn.imagesLoaded=function(r){var o=this,t=g.isFunction(g.Deferred)?g.Deferred():0,s=g.isFunction(t.notify),l=o.find("img").add(o.filter("img")),m=[],q=[],n=[];if(g.isPlainObject(r)){g.each(r,function(u,v){if(u==="callback"){r=v}else{if(t){t[u](v)}}})}function p(){var u=g(q),v=g(n);if(t){if(n.length){t.reject(l,u,v)}else{t.resolve(l)}}if(g.isFunction(r)){r.call(o,l,u,v)}}function k(u,v){if(u.src===c||g.inArray(u,m)!==-1){return}m.push(u);if(v){n.push(u)}else{q.push(u)}g.data(u,"imagesLoaded",{isBroken:v,src:u.src});if(s){t.notifyWith(g(u),[v,l,g(q),g(n)])}if(l.length===m.length){setTimeout(p);l.unbind(".imagesLoaded")}}if(!l.length){p()}else{l.bind("load.imagesLoaded error.imagesLoaded",function(u){k(u.target,u.type==="error")}).each(function(u,w){var x=w.src;var v=g.data(w,"imagesLoaded");if(v&&v.src===x){k(w,v.isBroken);return}if(w.complete&&w.naturalWidth!==e){k(w,w.naturalWidth===0||w.naturalHeight===0);return}if(w.readyState||w.complete){w.src=c;w.src=x}})}return t?t.promise(o):o};var d=g(h),f=h.Modernizr;g.Slicebox=function(k,l){this.$el=g(l);this._init(k)};g.Slicebox.defaults={orientation:"v",perspective:1200,cuboidsCount:5,cuboidsRandom:false,maxCuboidsCount:5,disperseFactor:0,colorHiddenSides:"#222",sequentialFactor:150,speed:600,easing:"ease",autoplay:false,interval:3000,fallbackFadeSpeed:300,onBeforeChange:function(k){return false},onAfterChange:function(k){return false},onReady:function(){return false}};g.Slicebox.prototype={_init:function(l){this.options=g.extend(true,{},g.Slicebox.defaults,l);this._validate();this.$items=this.$el.children("li");this.itemsCount=this.$items.length;if(this.itemsCount===0){return false}this.support=f.csstransitions&&f.csstransforms3d;this.current=0;this.isAnimating=false;this.isReady=false;var k=this;this.$el.imagesLoaded(function(){var n=k.$items.eq(k.current).css("display","block").addClass("sb-current");var m=new Image();m.src=n.find("img").attr("src");k.realWidth=m.width;k._setSize();k._setStyle();k._initEvents();k.options.onReady();k.isReady=true;if(k.options.autoplay){k._startSlideshow()}})},_validate:function(k){if(this.options.cuboidsCount<0){this.options.cuboidsCount=1}else{if(this.options.cuboidsCount>15){this.options.cuboidsCount=15}else{if(this.options.cuboidsCount%2===0){++this.options.cuboidsCount}}}if(this.options.maxCuboidsCount<0){this.options.maxCuboidsCount=1}else{if(this.options.maxCuboidsCount>15){this.options.maxCuboidsCount=15}else{if(this.options.maxCuboidsCount%2===0){++this.options.maxCuboidsCount}}}if(this.options.disperseFactor<0){this.options.disperseFactor=0}if(this.options.orientation!=="v"&&this.options.orientation!=="h"&&this.options.orientation!=="r"){this.options.orientation="v"}},_setSize:function(){var k=this.$items.eq(this.current).find("img");this.size={width:k.width(),height:k.height()}},_setStyle:function(){this.$el.css({"max-width":this.realWidth})},_initEvents:function(){var k=this;d.on("debouncedresize.slicebox",function(l){k._setSize()})},_startSlideshow:function(){var k=this;this.slideshow=setTimeout(function(){k._navigate("next");if(k.options.autoplay){k._startSlideshow()}},this.options.interval)},_stopSlideshow:function(){if(this.options.autoplay){clearTimeout(this.slideshow);this.isPlaying=false;this.options.autoplay=false}},_navigate:function(k,l){if(this.isAnimating||!this.isReady||this.itemsCount<2){return false}this.isAnimating=true;this.prev=this.current;if(l!==e){this.current=l}else{if(k==="next"){this.current=this.current<this.itemsCount-1?this.current+1:0}else{if(k==="prev"){this.current=this.current>0?this.current-1:this.itemsCount-1}}}this.options.onBeforeChange(this.current);if(!this.support){this._fade(k)}else{this._layout(k);this._rotate()}},_fade:function(l){var k=this,n=this.$items.eq(this.prev),m=n.find("img").height();this.$el.css("height",m);this.$items.css("position","absolute");this.$items.eq(this.current).fadeIn(this.options.fallbackFadeSpeed,function(){g(this).css("display","block").addClass("sb-current");k.$el.css("height","auto");k.$items.css("position","relative");k.isAnimating=false});k.$items.eq(k.prev).removeClass("sb-current").fadeOut(this.options.fallbackFadeSpeed)},_layout:function(n){var l=this.options.orientation;if(l==="r"){l=Math.floor(Math.random()*2)===0?"v":"h"}if(this.options.cuboidsRandom){this.options.cuboidsCount=Math.floor(Math.random()*this.options.maxCuboidsCount+1)}this._validate();var p={width:this.size.width,height:this.size.height,perspective:this.options.perspective+"px"},m=g.extend(this.options,{size:this.size,items:this.$items,direction:n,prev:this.prev,current:this.current,o:l}),k=this;this.$box=g("<div>").addClass("sb-perspective").css(p).appendTo(this.$el);this.cuboids=[];this.$el.css("overflow","visible");for(var o=0;o<this.options.cuboidsCount;++o){var q=new g.Cuboid(m,o);this.$box.append(q.getEl());this.cuboids.push(q)}},_rotate:function(){this.$items.eq(this.prev).removeClass("sb-current").hide();for(var l=0;l<this.options.cuboidsCount;++l){var m=this.cuboids[l],k=this;m.rotate(function(o){if(o===k.options.cuboidsCount-1){k.$el.css("overflow","hidden");k.isAnimating=false;k.$box.remove();var n=k.$items.eq(k.current);n.css("display","block");setTimeout(function(){n.addClass("sb-current")},0);k.options.onAfterChange(k.current)}})}},_destroy:function(k){this.$el.off(".slicebox").removeData("slicebox");d.off(".slicebox");k.call()},add:function(l,k){this.$items=this.$items.add(l);this.itemsCount=this.$items.length;if(k){k.call(l)}},next:function(){this._stopSlideshow();this._navigate("next")},previous:function(){this._stopSlideshow();this._navigate("prev")},jump:function(k){k-=1;if(k===this.current||k>=this.itemsCount||k<0){return false}this._stopSlideshow();this._navigate(k>this.current?"next":"prev",k)},play:function(){if(!this.isPlaying){this.isPlaying=true;this._navigate("next");this.options.autoplay=true;this._startSlideshow()}},pause:function(){if(this.isPlaying){this._stopSlideshow()}},isActive:function(){return this.isAnimating},destroy:function(k){this._destroy(k)}};g.Cuboid=function(k,l){this.config=k;this.pos=l;this.side=1;this._setSize();this._configureStyles()};g.Cuboid.prototype={_setSize:function(){this.size={width:this.config.o==="v"?Math.floor(this.config.size.width/this.config.cuboidsCount):this.config.size.width,height:this.config.o==="v"?this.config.size.height:Math.floor(this.config.size.height/this.config.cuboidsCount)};this.extra=this.config.o==="v"?this.config.size.width-(this.size.width*this.config.cuboidsCount):this.config.size.height-(this.size.height*this.config.cuboidsCount)},_configureStyles:function(){var m=Math.ceil(this.config.cuboidsCount/2),l=this.pos<m?{zIndex:(this.pos+1)*100,left:(this.config.o==="v")?this.size.width*this.pos:0,top:(this.config.o==="v")?0:this.size.height*this.pos}:{zIndex:(this.config.cuboidsCount-this.pos)*100,left:(this.config.o==="v")?this.size.width*this.pos:0,top:(this.config.o==="v")?0:this.size.height*this.pos};this.disperseFactor=this.config.disperseFactor*((this.pos+1)-m);this.style=g.extend({"-webkit-transition":"-webkit-transform "+this.config.speed+"ms "+this.config.easing,"-moz-transition":"-moz-transform "+this.config.speed+"ms "+this.config.easing,"-o-transition":"-o-transform "+this.config.speed+"ms "+this.config.easing,"-ms-transition":"-ms-transform "+this.config.speed+"ms "+this.config.easing,transition:"transform "+this.config.speed+"ms "+this.config.easing},l,this.size);this.animationStyles={side1:(this.config.o==="v")?{transform:"translate3d( 0, 0, -"+(this.size.height/2)+"px )"}:{transform:"translate3d( 0, 0, -"+(this.size.width/2)+"px )"},side2:(this.config.o==="v")?{transform:"translate3d( 0, 0, -"+(this.size.height/2)+"px ) rotate3d( 1, 0, 0, -90deg )"}:{transform:"translate3d( 0, 0, -"+(this.size.width/2)+"px ) rotate3d( 0, 1, 0, -90deg )"},side3:(this.config.o==="v")?{transform:"translate3d( 0, 0, -"+(this.size.height/2)+"px ) rotate3d( 1, 0, 0, -180deg )"}:{transform:"translate3d( 0, 0, -"+(this.size.width/2)+"px ) rotate3d( 0, 1, 0, -180deg )"},side4:(this.config.o==="v")?{transform:"translate3d( 0, 0, -"+(this.size.height/2)+"px ) rotate3d( 1, 0, 0, -270deg )"}:{transform:"translate3d( 0, 0, -"+(this.size.width/2)+"px ) rotate3d( 0, 1, 0, -270deg )"}};var k=(this.config.o==="v")?this.size.height:this.size.width;this.sidesStyles={frontSideStyle:{width:(this.config.o==="v")?this.size.width+this.extra:this.size.width,height:(this.config.o==="v")?this.size.height:this.size.height+this.extra,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 0deg ) translate3d( 0, 0, "+(k/2)+"px )"},backSideStyle:{width:this.size.width,height:this.size.height,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 180deg ) translate3d( 0, 0, "+(k/2)+"px ) rotateZ( 180deg )"},rightSideStyle:{width:k,height:(this.config.o==="v")?this.size.height:this.size.height+this.extra,left:(this.config.o==="v")?this.size.width/2-this.size.height/2:0,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 90deg ) translate3d( 0, 0, "+(this.size.width/2)+"px )"},leftSideStyle:{width:k,height:(this.config.o==="v")?this.size.height:this.size.height+this.extra,left:(this.config.o==="v")?this.size.width/2-this.size.height/2:0,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, -90deg ) translate3d( 0, 0, "+(this.size.width/2)+"px )"},topSideStyle:{width:(this.config.o==="v")?this.size.width+this.extra:this.size.width,height:k,top:(this.config.o==="v")?0:this.size.height/2-this.size.width/2,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 1, 0, 0, 90deg ) translate3d( 0, 0, "+(this.size.height/2)+"px )"},bottomSideStyle:{width:(this.config.o==="v")?this.size.width+this.extra:this.size.width,height:k,top:(this.config.o==="v")?0:this.size.height/2-this.size.width/2,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 1, 0, 0, -90deg ) translate3d( 0, 0, "+(this.size.height/2)+"px )"}}},getEl:function(){this.$el=g("<div/>").css(this.style).css(this.animationStyles.side1).append(g("<div/>").addClass("sb-side").css(this.sidesStyles.frontSideStyle)).append(g("<div/>").addClass("sb-side").css(this.sidesStyles.backSideStyle)).append(g("<div/>").addClass("sb-side").css(this.sidesStyles.rightSideStyle)).append(g("<div/>").addClass("sb-side").css(this.sidesStyles.leftSideStyle)).append(g("<div/>").addClass("sb-side").css(this.sidesStyles.topSideStyle)).append(g("<div/>").addClass("sb-side").css(this.sidesStyles.bottomSideStyle));this._showImage(this.config.prev);return this.$el},_showImage:function(m){var n,k=this.config.items.eq(m),l={"background-size":this.config.size.width+"px "+this.config.size.height+"px"};l.backgroundImage="url("+k.find("img").attr("src")+")";switch(this.side){case 1:n=0;break;case 2:n=(this.config.o==="v")?4:2;break;case 3:n=1;break;case 4:n=(this.config.o==="v")?5:3;break}l.backgroundPosition=(this.config.o==="v")?-(this.pos*this.size.width)+"px 0px":"0px -"+(this.pos*this.size.height)+"px";this.$el.children().eq(n).css(l)},rotate:function(m){var k=this,l;setTimeout(function(){if(k.config.direction==="next"){switch(k.side){case 1:l=k.animationStyles.side2;k.side=2;break;case 2:l=k.animationStyles.side3;k.side=3;break;case 3:l=k.animationStyles.side4;k.side=4;break;case 4:l=k.animationStyles.side1;k.side=1;break}}else{switch(k.side){case 1:l=k.animationStyles.side4;k.side=4;break;case 2:l=k.animationStyles.side1;k.side=1;break;case 3:l=k.animationStyles.side2;k.side=2;break;case 4:l=k.animationStyles.side3;k.side=3;break}}k._showImage(k.config.current);var o={},n={};if(k.config.o==="v"){o.left="+="+k.disperseFactor+"px";n.left="-="+k.disperseFactor+"px"}else{if(k.config.o==="h"){o.top="+="+k.disperseFactor+"px";n.top="-="+k.disperseFactor+"px"}}k.$el.css(l).animate(o,k.config.speed/2).animate(n,k.config.speed/2,function(){if(m){m.call(k,k.pos)}})},this.config.sequentialFactor*this.pos+30)}};var i=function(k){if(h.console){h.console.error(k)}};g.fn.slicebox=function(m){var k=g.data(this,"slicebox");if(typeof m==="string"){var l=Array.prototype.slice.call(arguments,1);this.each(function(){if(!k){i("cannot call methods on slicebox prior to initialization; attempted to call method '"+m+"'");return}if(!g.isFunction(k[m])||m.charAt(0)==="_"){i("no such method '"+m+"' for slicebox self");return}k[m].apply(k,l)})}else{this.each(function(){if(k){k._init()}else{k=g.data(this,"slicebox",new g.Slicebox(m,this))}})}return k}})(jQuery,window);